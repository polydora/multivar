---
title: "Краткое введение в мир линейной алгебры. Часть 2"
subtitle: "Анализ и визуализация многомерных данных с использованием R"
author: 
  - Вадим Хайтов
  - Марина Варфоломеева
  - Анастасия Лянгузова
company: 'Каф. Зоологии беспозвоночных, СПбГУ'
output:
  xaringan::moon_reader:
    self-contained: true
    lib_dir: libs
    css: [default, tamu-fonts, ninjutsu, "assets/xaringan-themer.css", "assets/xaringan.css"]
    df_print: default
    nature:
      highlightStyle: vs
      highlightLines: true
      countIncrementalSlides: false
      titleSlideClass: [middle, left, inverse]
      beforeInit: "assets/macros.js"
    includes:
      in_header: "assets/xaringan_in_header.html"
      after_body: "assets/xaringan_after_body.html"
---

```{r use-logo, echo=FALSE}
xaringanExtra::use_logo("assets/Linmod_logo.png", width = "40px")
```

## Вы сможете
- Объяснить что такое матрицы и какие бывают их основные разновидности
- Выполнить базовые операции с матрицами с использованием функций R
- Применить в среде R методы линейной алгебры для решения простейших задач

```{r setup, include = FALSE, cache = FALSE, purl = FALSE}
# output options
options(width = 70, scipen = 6, digits = 3)
library(knitr)
library(ggplot2)
library(grid)
library(gridExtra)


# chunk default options
opts_chunk$set(fig.align='center', tidy = FALSE, fig.width = 7, fig.height = 3, warning = FALSE)

ar <- arrow(type = "closed", length = unit(0.15,"cm"))
```

---

class: middle, center, inverse

# Level 1: Немного повторения: *Зоопарк матричных объектов* 

---

## Матричные объекты

- Есть много типов объектов, для которых такое выражение оказывается наиболее естественным (изображения, описания многомерных объектов и т.д.)
- В матрицах, как и в обычных числах, скрыта информация, которую можно извлекать и преобразовывать по определенным правилам

---

## Структура матриц

$$
\begin{pmatrix}
a_{11} & a_{12} & \cdots & a_{1c} \\
a_{21} & a_{22} & \cdots & a_{2c} \\    
\vdots & \vdots & \ddots & \vdots \\
a_{r1} & a_{r2} & \cdots & a_{rc}
\end{pmatrix}
$$

Размер (порядок) матрицы $r \times c$ 

---

## Векторы 

.pull-left[
Вектор-строка (Row matrix)

$$ 
\textbf {a} =
\begin{pmatrix}
1 & 2 & 3 
\end{pmatrix}
$$
]

.pull-right[
Вектор-столбец (column matrix)

$$ 
\textbf {b} =
\begin{pmatrix}
1 \\
4 \\    
7 \\
10 
\end{pmatrix}
$$
]

---

## Прямоугольные матрицы 

.pull-left[
$$ 
\textbf {C} =
\begin{pmatrix}
1 & 2 & 3 \\
4 & 5 & 6 \\    
7 & 8 & 9 \\
10 & 11 & 12 
\end{pmatrix}
$$
]

.pull-right[

$$ 
\textbf {D} =
\begin{pmatrix}
1 & 2 & 3 \\
4 & 5 & 6     
\end{pmatrix}
$$

]

В таком виде обычно представляются исходные данные при многомерном анализе. 

В такой матрице столбцы - признаки (p), а строки - объекты (n).

Лучше, когда n > p, то есть когда объектов больше, чем признаков.

---

## Квадратные матрицы (square matrices)

Это наиболее "операбельные" матрицы

.pull-left[
$$ 
\textbf {E} =
\begin{pmatrix}
1 & 2 & 3 \\
4 & 5 & 6 \\    
7 & 8 & 9 
\end{pmatrix}
$$
]

.pull-right[
$$ 
\textbf {F} =
\begin{pmatrix}
1 & 0 & 0 & 0 \\
0 & 5 & 0 & 0 \\    
0 & 0 & 9 & 0 \\
0 & 0 & 0 & 1
\end{pmatrix}
$$
Диагональные матрицы (diagonal matrix) 

Иногда в них удобно превращать векторы
]

---

## Треугольные матрицы (triangular matrices)


$$ 
\textbf {H} =
\begin{pmatrix}
1 & 2 & 3 & 4 \\
0 & 5 & 6 & 7 \\    
0 & 0 & 9 & 10 \\
0 & 0 & 0 & 1
\end{pmatrix}
$$

или

$$ 
\textbf {H} =
\begin{pmatrix}
1 & 0 & 0 & 0 \\
3 & 5 & 0 & 0 \\    
4 & 7 & 9 & 0 \\
5 & 8 & 10 & 11
\end{pmatrix}
$$

---

## Единичная матрица (identity matrix)



$$ 
\textbf {I} =
\begin{pmatrix}
1 & 0 & 0 & 0 \\
0 & 1 & 0 & 0 \\    
0 & 0 & 1 & 0 \\
0 & 0 & 0 & 1
\end{pmatrix}
$$


Единичная матрица (обозначение $\textbf{I}$) занимают особое место в матричной алгебре.   
Она выполняет ту же роль, которую выполняет единица в обычной алгебре. 


---


## Матрицы ассоциации

Изначально результаты исследования имеют вид исходной матрицы (обычно прямоугольной)

$\textbf {Y} = [n_{objects} \times p_{descriptors}]$

Информация из этой матрицы конденсируется в двух других матрицах 


Q анализ

$\textbf {A}_{nn} = [n_{objects} \times n_{objects}]$

R анализ

$\textbf{A}_{pp} = [p_{descriptors} \times p_{descriptors}]$

---

## Матрицы ассоциации 

Это симметричные квадратные матрицы

$$
\textbf{A}_{pp} = 
\begin{pmatrix}
a_{11} & a_{12} & \cdots & a_{1p} \\
a_{21} & a_{22} & \cdots & a_{2p} \\    
\vdots & \vdots & \ddots & \vdots \\
a_{p1} & a_{p2} & \cdots & a_{pp}
\end{pmatrix}
$$


В этой матрице $a_{ij} = a_{ji}$

Большинство многомерных методов имеет дело именно с такими матрицами

---


## Особенность квадратных матриц

Для квадратных матриц могут быть найдены (но не обязательно существуют) некоторые важные для линейной алгебры показатели: *определитель*, *инверсия*, *собственные значения* и *собственные векторы*


--- 
 
## Задание
Создайте с помощью R следующие матрицы

```{r, echo=FALSE, purl=FALSE}
matrix(1:12, ncol = 3)
```



```{r, echo=FALSE, purl=FALSE}
diag(seq(1,5))
```

---

class: middle, center, inverse


# Level 2: Еще немного повторения: *Простейшие операции с матричными объектами*

---

## Транспонирование матриц

```{r, purl=TRUE}
A <- matrix(1:12, ncol = 3)
A
```

Транспонированная матрица $\textbf{B} = \textbf{A}'$ синонимичная запись $\textbf{B} = \textbf{A}^{T}$

```{r, purl=TRUE}
B <- t(A)
B
```

---

## Сложение матриц

```{r, purl=TRUE}
A + 4
```


```{r, purl=TRUE}
A + A
```

Но! Нельзя складывать матрицы разных размеров
```{r, eval=FALSE, purl=TRUE}
A + B
```

---

## Простое умножение 

Умножение на число
```{r, purl=TRUE}
A * 4
```

Простое умножение матрицы на вектор возможно только если число элементов в векторе равно числу строк в матрице

```{r, purl=TRUE}
A * c(10, 11, 12, 13)

```

Все элементы первой строки матрицы умножаются на первый элемент вектора, все элементы второй строки на второй элемент вектора и т.д.  








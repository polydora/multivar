<!DOCTYPE html>
<html>
<head>
  <title>Знакомство с многомерными данными</title>

  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="chrome=1">
  <meta name="generator" content="pandoc" />




  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="apple-mobile-web-app-capable" content="yes">

  <base target="_blank">

  <script type="text/javascript">
    var SLIDE_CONFIG = {
      // Slide settings
      settings: {
                title: 'Знакомство с многомерными данными',
                        subtitle: 'Анализ и визуализация многомерных данных с использованием R',
                useBuilds: true,
        usePrettify: true,
        enableSlideAreas: true,
        enableTouch: true,
                        favIcon: '01_multivariate_data_and_dissimilarities_files/logo.png',
              },

      // Author information
      presenters: [
            {
        name:  'Вадим Хайтов, Марина Варфоломеева' ,
        company: '',
        gplus: '',
        twitter: '',
        www: '',
        github: ''
      },
            ]
    };
  </script>

  <script src="site_libs/header-attrs-2.11/header-attrs.js"></script>
  <link href="site_libs/ioslides-13.5.1/fonts/fonts.css" rel="stylesheet" />
  <link href="site_libs/ioslides-13.5.1/theme/css/default.css" rel="stylesheet" />
  <link href="site_libs/ioslides-13.5.1/theme/css/phone.css" rel="stylesheet" />
  <script src="site_libs/ioslides-13.5.1/js/modernizr.custom.45394.js"></script>
  <script src="site_libs/ioslides-13.5.1/js/prettify/prettify.js"></script>
  <script src="site_libs/ioslides-13.5.1/js/prettify/lang-r.js"></script>
  <script src="site_libs/ioslides-13.5.1/js/prettify/lang-yaml.js"></script>
  <script src="site_libs/ioslides-13.5.1/js/hammer.js"></script>
  <script src="site_libs/ioslides-13.5.1/js/slide-controller.js"></script>
  <script src="site_libs/ioslides-13.5.1/js/slide-deck.js"></script>

  <style type="text/css">

    b, strong {
      font-weight: bold;
    }

    em {
      font-style: italic;
    }

    summary {
      display: list-item;
    }

    slides > slide {
      -webkit-transition: all 0.4s ease-in-out;
      -moz-transition: all 0.4s ease-in-out;
      -o-transition: all 0.4s ease-in-out;
      transition: all 0.4s ease-in-out;
    }

    .auto-fadein {
      -webkit-transition: opacity 0.6s ease-in;
      -webkit-transition-delay: 0.4s;
      -moz-transition: opacity 0.6s ease-in 0.4s;
      -o-transition: opacity 0.6s ease-in 0.4s;
      transition: opacity 0.6s ease-in 0.4s;
      opacity: 0;
    }
/* https://github.com/ropensci/plotly/pull/524#issuecomment-468142578 */
slide:not(.current) .plotly.html-widget{
  display: block;
}

    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    span.underline{text-decoration: underline;}
    div.column{display: inline-block; vertical-align: top; width: 50%;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
            pre > code.sourceCode { white-space: pre; position: relative; }
            pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
            pre > code.sourceCode > span:empty { height: 1.2em; }
            .sourceCode { overflow: visible; }
            code.sourceCode > span { color: inherit; text-decoration: inherit; }
            div.sourceCode { margin: 1em 0; }
            pre.sourceCode { margin: 0; }
            @media screen {
            div.sourceCode { overflow: auto; }
            }
            @media print {
            pre > code.sourceCode { white-space: pre-wrap; }
            pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
            }
            pre.numberSource code
              { counter-reset: source-line 0; }
            pre.numberSource code > span
              { position: relative; left: -4em; counter-increment: source-line; }
            pre.numberSource code > span > a:first-child::before
              { content: counter(source-line);
                position: relative; left: -1em; text-align: right; vertical-align: baseline;
                border: none; display: inline-block;
                -webkit-touch-callout: none; -webkit-user-select: none;
                -khtml-user-select: none; -moz-user-select: none;
                -ms-user-select: none; user-select: none;
                padding: 0 4px; width: 4em;
                color: #aaaaaa;
              }
            pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
            div.sourceCode
              {   }
            @media screen {
            pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
            }
            code span.al { color: #ff0000; font-weight: bold; } /* Alert */
            code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
            code span.at { color: #7d9029; } /* Attribute */
            code span.bn { color: #40a070; } /* BaseN */
            code span.bu { } /* BuiltIn */
            code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
            code span.ch { color: #4070a0; } /* Char */
            code span.cn { color: #880000; } /* Constant */
            code span.co { color: #60a0b0; font-style: italic; } /* Comment */
            code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
            code span.do { color: #ba2121; font-style: italic; } /* Documentation */
            code span.dt { color: #902000; } /* DataType */
            code span.dv { color: #40a070; } /* DecVal */
            code span.er { color: #ff0000; font-weight: bold; } /* Error */
            code span.ex { } /* Extension */
            code span.fl { color: #40a070; } /* Float */
            code span.fu { color: #06287e; } /* Function */
            code span.im { } /* Import */
            code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
            code span.kw { color: #007020; font-weight: bold; } /* Keyword */
            code span.op { color: #666666; } /* Operator */
            code span.ot { color: #007020; } /* Other */
            code span.pp { color: #bc7a00; } /* Preprocessor */
            code span.sc { color: #4070a0; } /* SpecialChar */
            code span.ss { color: #bb6688; } /* SpecialString */
            code span.st { color: #4070a0; } /* String */
            code span.va { color: #19177c; } /* Variable */
            code span.vs { color: #4070a0; } /* VerbatimString */
            code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
        
    slides > slide:not(.nobackground):before {
      font-size: 12pt;
      content: "";
      position: absolute;
      bottom: 20px;
      left: 60px;
      background: url(01_multivariate_data_and_dissimilarities_files/logo.png) no-repeat 0 50%;
      -webkit-background-size: 30px 30px;
      -moz-background-size: 30px 30px;
      -o-background-size: 30px 30px;
      background-size: 30px 30px;
      padding-left: 40px;
      height: 30px;
      line-height: 1.9;
    }
  </style>

  <link rel="stylesheet" href="assets/my_styles.css" type="text/css" />

</head>

<body style="opacity: 0">

<slides class="layout-widescreen">

  <slide class="title-slide segue nobackground">
        <aside class="gdbar"><img src="01_multivariate_data_and_dissimilarities_files/logo.png"></aside>
        <!-- The content of this hgroup is replaced programmatically through the slide_config.json. -->
    <hgroup class="auto-fadein">
      <h1 data-config-title><!-- populated from slide_config.json --></h1>
      <h2 data-config-subtitle><!-- populated from slide_config.json --></h2>
      <p data-config-presenter><!-- populated from slide_config.json --></p>
          </hgroup>
  </slide>

<slide class=""><hgroup><h2>Вы сможете</h2></hgroup><article  id="вы-сможете">

<ul>
<li>Объяснить почему для некоторых задач больше подходят многомерные данные</li>
<li>Объяснить суть понятия &ldquo;многомерное пространство признаков&rdquo;</li>
<li>Представить многомерные данные в виде матриц описания значений признаков для объектов</li>
<li>Оценить сходство/различие между объектами с помощью специальных коэффициентов</li>
<li>Описать <em>взаиморасположение</em> объектов в многомерном пространстве признаков с помощью матриц</li>
<li>Визуализировать взаиморасположение объектов с помощью простейших методов</li>
</ul>

</article></slide><slide class="segue dark nobackground level1"><hgroup class = 'auto-fadein'><h2>Общая характеристика многомерных методов</h2></hgroup><article  id="общая-характеристика-многомерных-методов">

</article></slide><slide class=""><hgroup><h2>Почему нужны многомерные методы?</h2></hgroup><article  id="почему-нужны-многомерные-методы">

<p>Пусть у нас имеется две группы объектов, у которых мы изучили некий признак. Мы хотим тестировать гипотезу о том, что эти две группы различаются.</p>

<p>Вспомним логику тестирования гипотез.</p>

<p><img src="01_multivariate_data_and_dissimilarities_files/figure-html/unnamed-chunk-1-1.png" width="672" style="display: block; margin: auto;" /></p>

</article></slide><slide class=""><hgroup><h2>Почему нужны многомерные методы?</h2></hgroup><article  id="почему-нужны-многомерные-методы-1">

<p>Теперь представим, что наш объект, по своей природе, не может быть описан только по одному признаку</p>

<ul>
<li>Сообщества (признаки - виды)</li>
<li>Форма тела (признаки - размеры тех или иных частей)</li>
<li>Социальная активность животного (признаки - проявление того или иного паттерна)</li>
<li>Общественное мнение (признаки - ответы на разные вопросы анкет)</li>
<li>Транскриптом (признаки - транскрипты)</li>
</ul>

</article></slide><slide class=""><hgroup><h2>Почему нужны многомерные методы?</h2></hgroup><article  id="почему-нужны-многомерные-методы-2">

<p>Предположим, что объекты характеризуются только двумя признаками</p>

<p><img src="01_multivariate_data_and_dissimilarities_files/figure-html/unnamed-chunk-2-1.png" width="672" style="display: block; margin: auto;" /></p>

</article></slide><slide class=""><hgroup><h2>Какие задачи решаются методами могомерной статистики?</h2></hgroup><article  id="какие-задачи-решаются-методами-могомерной-статистики">

<ul class = 'build'>
<li>Выявление взаимоотношений (сходства-различия) между объектами (или признаками):</li>
<li>Классификация (Кластерный анализ)</li>
<li>Ординация. В том числе картирование пространственно выраженных объектов (nMDS, PCA).</li>
<li>Тестирование гипотез о различиях между группами объектов (ANOSIM, PERMANOVA).</li>
<li>Выявление связи между группами признаков (тест Мантела, BIOENV, RDA, CCA).</li>
</ul>

</article></slide><slide class=""><hgroup><h2>Признаки и объекты</h2></hgroup><article  id="признаки-и-объекты">

<p>Данные представляются в виде таблицы (матрицы), где строками являются объекты (Objects), а столбцами признаки (Descriptors).</p>

</article></slide><slide class=""><hgroup><h2>R и Q анализы</h2></hgroup><article  id="r-и-q-анализы">

<img src='images/R%20Q%20analysis.png' title='fig:'/><p class='caption'>R и Q</p>

<ul>
<li>R-анализ: Выясняем взаимоотношения между признаками</li>
<li>Q-анализ: Выясняем взаимоотношения между объектами</li>
</ul>

</article></slide><slide class=""><hgroup><h2>Геометрическая интерпретация Q-анализа</h2></hgroup><article  id="геометрическая-интерпретация-q-анализа">

<ul>
<li>Признаки - оси</li>
<li>Объекты - точки</li>
</ul>

<p><img src="01_multivariate_data_and_dissimilarities_files/figure-html/unnamed-chunk-3-1.png" width="672" style="display: block; margin: auto;" /></p>

</article></slide><slide class=""><hgroup><h2>Описание расположения объектов в многомерном пространстве признаков</h2></hgroup><article  id="описание-расположения-объектов-в-многомерном-пространстве-признаков">

<p>В большинстве случаев нас интересуют не абсолютные значения координат (признаков), а <em>взаиморасположение</em> точек в многомерном пространстве.</p>

<p>Существует два основных способа описания.</p>

</article></slide><slide class=""><hgroup><h2>Способ 1. Геометрическое описание (линейная алгебра)</h2></hgroup><article  id="способ-1.-геометрическое-описание-линейная-алгебра" class="smaller columns-2">

<p><img src="01_multivariate_data_and_dissimilarities_files/figure-html/unnamed-chunk-4-1.png" width="480" style="display: block; margin: auto;" /></p>

<p>Для описания взаиморасположения точек необходимо иметь два набора данных</p>

<p>Матрицу углов между векторами (косинусов углов)</p>

<p>\[\begin{pmatrix}
\alpha_{11} &amp; \alpha_{12} &amp; \cdots &amp; \alpha_{1n} \\
\alpha_{21} &amp; \alpha_{22} &amp; \cdots &amp; \alpha_{2n} \\    
\vdots &amp; \vdots &amp; \ddots &amp; \vdots \\
\alpha_{n1} &amp; \alpha_{n2} &amp; \cdots &amp; \alpha_{nn}
\end{pmatrix}\]</p>

<p>Ряд длин векторов \[\begin{vmatrix} LV1 \\ LV2 \\ ... \\ LVn \end{vmatrix}\]</p>

<p>Этот способ описания, с разными вариациями, будет применяться в методах <em>PCA, CA, CCA, RDA</em></p>

</article></slide><slide class=""><hgroup><h2>Способ 2. Через вычисление матрицы попарных расстояний (Similarity/Dissimilarity matrix)</h2></hgroup><article  id="способ-2.-через-вычисление-матрицы-попарных-расстояний-similaritydissimilarity-matrix" class="smaller columns-2">

<p><img src="01_multivariate_data_and_dissimilarities_files/figure-html/unnamed-chunk-5-1.png" width="480" style="display: block; margin: auto;" /></p>

<p>В анализ вовлекается матрица попарных расстояний (сходств) между объектами. Эта матрица однозначно описывает взаиморасположение между объектами.</p>

<p>Этот способ представления взаиморасположения лежит в основе <em>Иерархического кластерного анализа, MDS, теста Мантела, ANOSIM, PERMANOVA, процедуры BIOENV</em></p>

</article></slide><slide class="segue dark nobackground level1"><hgroup class = 'auto-fadein'><h2>Простейший многомерный анализ</h2></hgroup><article  id="простейший-многомерный-анализ">

</article></slide><slide class=""><hgroup><h2>Простейшая матрица значений признаков</h2></hgroup><article  id="простейшая-матрица-значений-признаков">

<p>Два объекта и два признака</p>

<table class = 'rmdtable'>
<tr class="header">
<th align="left"></th>
<th align="center">Признак А</th>
<th align="center">Признак B</th>
</tr>
<tr class="odd">
<td align="left">Объект 1</td>
<td align="center">1</td>
<td align="center">1</td>
</tr>
<tr class="even">
<td align="left">Объект 2</td>
<td align="center">2</td>
<td align="center">2</td>
</tr>
</table>

</article></slide><slide class=""><hgroup><h2>Геометрическая интерпретация простейшей матрицы</h2></hgroup><article  id="геометрическая-интерпретация-простейшей-матрицы">

<p><img src="01_multivariate_data_and_dissimilarities_files/figure-html/unnamed-chunk-7-1.png" width="672" style="display: block; margin: auto;" /></p>

</article></slide><slide class=""><hgroup><h2>Евклидово расстояние</h2></hgroup><article  id="евклидово-расстояние" class="smaller">

<p>Это простейший способ описания расстояния между объектами в пространстве признаков.</p>

<p><img src="01_multivariate_data_and_dissimilarities_files/figure-html/unnamed-chunk-8-1.png" width="672" style="display: block; margin: auto;" /></p>

<p>По теореме Пифагора</p>

<ul class = 'build'>
<li>\[
D = \sqrt{(A_2 - A_1)^2 + (B_2 - B_1)^2}
\]</li>
</ul>

<ul class = 'build'>
<li>Расстояние между объектами выражается просто числом D = 1.414</li>
</ul>

<ul class = 'build'>
<li><strong>At!</strong> Эта мера различия между объектами не единственная, и далеко не всегда правильная (об этом далее).</li>
</ul>

</article></slide><slide class=""><hgroup><h2>Усложняем задачу: объектов становится больше двух</h2></hgroup><article  id="усложняем-задачу-объектов-становится-больше-двух">

<table class = 'rmdtable'>
<tr class="header">
<th align="left">Объект</th>
<th align="center">Признак А</th>
<th align="center">Признак B</th>
</tr>
<tr class="odd">
<td align="left">Object 1</td>
<td align="center">2.0</td>
<td align="center">5</td>
</tr>
<tr class="even">
<td align="left">Object 2</td>
<td align="center">2.0</td>
<td align="center">10</td>
</tr>
<tr class="odd">
<td align="left">Object 3</td>
<td align="center">4.0</td>
<td align="center">8</td>
</tr>
<tr class="even">
<td align="left">Object 4</td>
<td align="center">2.5</td>
<td align="center">4</td>
</tr>
</table>

</article></slide><slide class=""><hgroup><h2>Геометрическая интерпретация</h2></hgroup><article  id="геометрическая-интерпретация">

<p><img src="01_multivariate_data_and_dissimilarities_files/figure-html/unnamed-chunk-10-1.png" width="672" style="display: block; margin: auto;" /></p>

</article></slide><slide class=""><hgroup><h2>Матрица расстояний (Similarity/Dissimilarity matrix)</h2></hgroup><article  id="матрица-расстояний-similaritydissimilarity-matrix">

<p>Когда объектов больше двух, то расстояния между объектами можно выразить <strong>матрицей расстояний</strong>.</p>

<pre >##     1   2   3   4
## 1 0.0 5.0 3.6 1.1
## 2 5.0 0.0 2.8 6.0
## 3 3.6 2.8 0.0 4.3
## 4 1.1 6.0 4.3 0.0</pre>

<p>Охарактеризуйте эту матрицу</p>

<ul class = 'build'>
<li>Квадратная матрица</li>
<li>Симметричная матрица</li>
</ul>

</article></slide><slide class=""><hgroup><h2>Усложняем задачу: признаков становится больше двух</h2></hgroup><article  id="усложняем-задачу-признаков-становится-больше-двух">

<table class = 'rmdtable'>
<tr class="header">
<th align="left">Объект</th>
<th align="center">Признак А</th>
<th align="center">Признак B</th>
<th align="center">Признак С</th>
<th align="center">Признак D</th>
</tr>
<tr class="odd">
<td align="left">Object 1</td>
<td align="center">2.0</td>
<td align="center">5</td>
<td align="center">100</td>
<td align="center">0.10</td>
</tr>
<tr class="even">
<td align="left">Object 2</td>
<td align="center">2.0</td>
<td align="center">10</td>
<td align="center">258</td>
<td align="center">0.01</td>
</tr>
<tr class="odd">
<td align="left">Object 3</td>
<td align="center">4.0</td>
<td align="center">8</td>
<td align="center">122</td>
<td align="center">0.09</td>
</tr>
<tr class="even">
<td align="left">Object 4</td>
<td align="center">2.5</td>
<td align="center">4</td>
<td align="center">10000</td>
<td align="center">0.15</td>
</tr>
</table>

</article></slide><slide class=""><hgroup><h2>Геометрическая интрепретация</h2></hgroup><article  id="геометрическая-интрепретация">

<p>Облако точек в n-мерном пространстве значений признаков.</p>

<p><strong>At!</strong> Не пытайтесь представить n-мерный объект… Просто работайте с ним.</p>

<ul class = 'build'>
<li>Warning

<center>

<img src='images/Shurik.jpg' title=''/></li>
</ul>

</center>

</article></slide><slide class=""><hgroup><h2>Эвклидово расстояние в n-мерном пространстве</h2></hgroup><article  id="эвклидово-расстояние-в-n-мерном-пространстве">

<p>\[D = \sqrt{\sum(x_{i,j} - x_{i,k})^2}\]</p>

<p>В n-мерном пространстве соблюдаются те же законы, что и на плоскости.</p>

</article></slide><slide class=""><hgroup><h2>Три способа изображения матрицы расстояний</h2></hgroup><article  id="три-способа-изображения-матрицы-расстояний">

<pre >##        1      2      3      4
## 1    0.0  158.1   22.3 9900.0
## 2  158.1    0.0  136.0 9742.0
## 3   22.3  136.0    0.0 9878.0
## 4 9900.0 9742.0 9878.0    0.0</pre>

<pre >##        1      2      3      4
## 1    0.0                     
## 2  158.1    0.0              
## 3   22.3  136.0    0.0       
## 4 9900.0 9742.0 9878.0    0.0</pre>

<pre >##        1      2      3
## 2  158.1              
## 3   22.3  136.0       
## 4 9900.0 9742.0 9878.0</pre>

<p>Количество значимых чисел в треугольной матрице:</p>

<p>\[N = \frac{n^2 - n}{2}\]</p>

</article></slide><slide class=""><hgroup><h2>Матрица расстояний в развернутом виде (Unfolded dissimilarity matrix)</h2></hgroup><article  id="матрица-расстояний-в-развернутом-виде-unfolded-dissimilarity-matrix">

<pre >##        1      2      3
## 2  158.1              
## 3   22.3  136.0       
## 4 9900.0 9742.0 9878.0</pre>

<pre >## [1]  158.1   22.3 9900.0  136.0 9742.0 9878.0</pre>

</article></slide><slide class=""><hgroup><h2>Результаты простейшего могомерного анализа</h2></hgroup><article  id="результаты-простейшего-могомерного-анализа" class="columns-2 smaller">

<p><strong>Исходная матрица признаков</strong></p>

<table class = 'rmdtable'>
<tr class="header">
<th align="left">Объект</th>
<th align="center">Признак А</th>
<th align="center">Признак B</th>
<th align="center">Признак С</th>
<th align="center">Признак D</th>
</tr>
<tr class="odd">
<td align="left">Object 1</td>
<td align="center">2.0</td>
<td align="center">5</td>
<td align="center">100</td>
<td align="center">0.10</td>
</tr>
<tr class="even">
<td align="left">Object 2</td>
<td align="center">2.0</td>
<td align="center">10</td>
<td align="center">258</td>
<td align="center">0.01</td>
</tr>
<tr class="odd">
<td align="left">Object 3</td>
<td align="center">4.0</td>
<td align="center">8</td>
<td align="center">122</td>
<td align="center">0.09</td>
</tr>
<tr class="even">
<td align="left">Object 4</td>
<td align="center">2.5</td>
<td align="center">4</td>
<td align="center">10000</td>
<td align="center">0.15</td>
</tr>
</table>

<p><br> <strong>Матрица расстояний</strong></p>

<pre >##        1      2      3
## 2  158.1              
## 3   22.3  136.0       
## 4 9900.0 9742.0 9878.0</pre>

<ul class = 'build'>
<li>Какие объекты наиболее похожи друг на друга?<br/></li>
<li>Какие объекты наиболее различны?</li>
<li>В чем проблема данного анализа?</li>
</ul>

</article></slide><slide class="segue dark nobackground level1"><hgroup class = 'auto-fadein'><h2>Простейший анализ реальных многомерных данных</h2></hgroup><article  id="простейший-анализ-реальных-многомерных-данных">

</article></slide><slide class=""><hgroup><h2>Пример: Сообщества бентоса акватории Долгой губы (о. Б. Соловецкий, Белое море)</h2></hgroup><article  id="пример-сообщества-бентоса-акватории-долгой-губы-о.-б.-соловецкий-белое-море">

<p>В этом примере используется сокращенный набор данных о бентосе Долгой губы (Нинбург, 1990; Хайтов и др., 2013) — только численность наиболее обильных видов на 68 станциях.</p>

<div class="smaller">
<ul>
<li><code>dolg_abundance.txt</code> — данные об обилии 25 видов</li>
<li><code>dolg_hydrology.txt</code> — данные о 4 гидрологических характеристиках: глубина, Температура придонной воды, Соленость, Степень гидратации грунта</li>
</ul></div>

<p><img src="01_multivariate_data_and_dissimilarities_files/figure-html/unnamed-chunk-17-1.png" width="432" style="display: block; margin: auto;" /></p>

</article></slide><slide class=""><hgroup><h2>Читаем данные</h2></hgroup><article  id="читаем-данные">

<pre class = 'prettyprint lang-r'>abund &lt;- read.table(&quot;data/dolg_abundance.txt&quot;, skip = 1, header = TRUE, sep = &quot;;&quot;)
hydrol &lt;- read.table(&quot;data/dolg_hydrology.txt&quot;, skip = 1, header = TRUE, sep = &quot;;&quot;)</pre>

</article></slide><slide class=""><hgroup><h2>Вопрос для многомерного анализа</h2></hgroup><article  id="вопрос-для-многомерного-анализа">

<p>Существуют ли группировки описаний, сходных по населению?</p>

<p>Задание: Нарисуйте на бумаге как, по вашему мнению, должны располагаться объекты (описания-станции) в n-мерном пространстве признаков, если существует две группировки.</p>

</article></slide><slide class=""><hgroup><h2>Подготовка данных для анализа</h2></hgroup><article  id="подготовка-данных-для-анализа">

<p>Переменные могут быть измерены в разных шкалах</p>

<ul>
<li>численность, биомасса и проективное покрытие разных организмов</li>
<li>температура воды, соленость и концентрация биогенов</li>
<li>Размеры частей тела, количество частей тела, площадь частей тела</li>
</ul>

<p>Для таких случаев необходима стандартизация величин. Этот прием будет постоянно применяться при многомерных анализах, основанных на матричной алгебре.</p>

<p>\[x_{stand} = \frac{x_i - \bar{x}}{\sigma_x}\]</p>

<ul class = 'build'>
<li><strong>Вопрос:</strong> Какими свойствами обладают стандартизованные величины?</li>
<li>Среднее значение равно нулю.</li>
<li>Среднеквадратичное отклонение равно единице.</li>
</ul>

</article></slide><slide class=""><hgroup><h2>Подготовка данных для анализа</h2></hgroup><article  id="подготовка-данных-для-анализа-1">

<p>В ряде случаев (особенно в экологических исследованиях) необходимо перевести абсолютные значения в относительные (доли от суммы или от максимума)</p>

<p>\[x_{rel} = \frac{x_i}{\sum x_i} \times 100 \%\]</p>

<p>\[x_{rel} = \frac{x_i}{max(x_i)} \times 100 \%\]</p>

</article></slide><slide class=""><hgroup><h2>Подготовка данных для анализа</h2></hgroup><article  id="подготовка-данных-для-анализа-2" class="smaller">

<p>Часто возникает ситуация, когда один признак (или несколько признаков) имеет существенно более высокие абсолютные значения, чем все остальные, или варьирует в более широких пределах, чем остальные признаки.</p>

<p><img src="01_multivariate_data_and_dissimilarities_files/figure-html/unnamed-chunk-19-1.png" width="672" style="display: block; margin: auto;" /></p>

<p>В такой ситуации необходима <em>трансформация</em> , которая &ldquo;уравнивает&rdquo; силу влияния признаков.</p>

<p>По силе эффекта трансформирующие функции распределяются так:</p>

<p>Отсутствие трансформации \(\Rightarrow\) Квадратный корень \(\Rightarrow\) Корень четвертой степени \(\Rightarrow\) Логарифм \(log(x_i +1)\) \(\Rightarrow\) Присутствие отсутствие (1, 0)</p>

</article></slide><slide class=""><hgroup><h2>Задание:</h2></hgroup><article  id="задание">

<p>На основе датасета, содержащего данные по обилию видов, создайте матрицу, содержащую относительные величины (доли обилия каждого вида в общем обилии организмов на данной станции)</p>

<p>Hint: Воспользуйтесь функцией <code>apply()</code></p>

</article></slide><slide class=""><hgroup><h2>Решение</h2></hgroup><article  id="решение">

<pre class = 'prettyprint lang-r'>total &lt;- apply(abund[, -1], MARGIN = 1,FUN = sum)
abund_rel &lt;- abund[, -1] / total

head(abund_rel[,1:3])</pre>

<pre >##   Eteone_longa Nemertini Harmothoe_imbricata
## 1       0.0000   0.00772              0.0232
## 2       0.0000   0.00000              0.0000
## 3       0.0000   0.00000              0.0000
## 4       0.0000   0.00000              0.0000
## 5       0.0000   0.02857              0.0000
## 6       0.0143   0.01429              0.0000</pre>

</article></slide><slide class=""><hgroup><h2>Знакомимся с пакетом <code>vegan</code> (Oksanen et al., 2015)</h2></hgroup><article  id="знакомимся-с-пакетом-vegan-oksanen-et-al.-2015">

<pre class = 'prettyprint lang-r'>library (vegan)</pre>

<ul>
<li>Пакет <code>vegan</code> позволяет проводить много типов многомерных анализов (но не все!).</li>
<li>Ориентирован на экологические данные, отсюда много экологических терминов (признаки – &ldquo;species&rdquo;, объекты – &ldquo;sites&rdquo;)</li>
<li>Исчерпывающее описание методов, реализованных в <code>vegan</code>, дается в &ldquo;Numerical ecology&rdquo; (Legendre &amp; Legendre, 2012)</li>
<li>Альтернатива – пакет <code>ade4</code></li>
</ul>

</article></slide><slide class=""><hgroup><h2>Подготовка данных в пакете <code>vegan</code></h2></hgroup><article  id="подготовка-данных-в-пакете-vegan">

<p>Относительные величины</p>

<pre class = 'prettyprint lang-r'>abund_rel &lt;- decostand(abund[,-1], method = &quot;total&quot;, MARGIN = 1)
head(abund_rel[, 1:3])</pre>

<pre >##   Eteone_longa Nemertini Harmothoe_imbricata
## 1       0.0000   0.00772              0.0232
## 2       0.0000   0.00000              0.0000
## 3       0.0000   0.00000              0.0000
## 4       0.0000   0.00000              0.0000
## 5       0.0000   0.02857              0.0000
## 6       0.0143   0.01429              0.0000</pre>

</article></slide><slide class=""><hgroup><h2>Задание</h2></hgroup><article  id="задание-1">

<p>С помощью пакета <code>vegan</code> создайте еще два датасета:</p>

<ul>
<li><code>abund_stand</code> – Стандартизованные величины обилий видов</li>
<li><code>abund_log</code> – Логарифмированные величины обилий видов</li>
</ul>

</article></slide><slide class=""><hgroup><h2>Решение: стандартизация в <code>vegan</code></h2></hgroup><article  id="решение-стандартизация-в-vegan">

<pre class = 'prettyprint lang-r'>abund_stand &lt;- decostand(abund[,-1], method = &quot;standardize&quot;, MARGIN = 2)
head(abund_stand[, 1:3])</pre>

<pre >##   Eteone_longa Nemertini Harmothoe_imbricata
## 1       -0.329    0.6878               2.783
## 2       -0.329   -0.5594              -0.508
## 3       -0.329   -0.5594              -0.508
## 4       -0.329   -0.5594              -0.508
## 5       -0.329    0.6878              -0.508
## 6        0.118    0.0642              -0.508</pre>

</article></slide><slide class=""><hgroup><h2>Решение: log-трансформация в <code>vegan</code></h2></hgroup><article  id="решение-log-трансформация-в-vegan">

<pre class = 'prettyprint lang-r'>abund_log &lt;-  decostand(abund[,-1], method = &quot;log&quot;, MARGIN = 2)
head(abund_log[, 1:3])</pre>

<pre >##   Eteone_longa Nemertini Harmothoe_imbricata
## 1         0.00      6.32                7.91
## 2         0.00      0.00                0.00
## 3         0.00      0.00                0.00
## 4         0.00      0.00                0.00
## 5         0.00      6.32                0.00
## 6         5.32      5.32                0.00</pre>

</article></slide><slide class=""><hgroup><h2>Матрицы расстояний в пакете <code>vegan</code></h2></hgroup><article  id="матрицы-расстояний-в-пакете-vegan">

<pre class = 'prettyprint lang-r'>dist_init &lt;- vegdist(abund[,-1], method = &quot;euclidean&quot;)
dist_stand &lt;- vegdist(abund_stand, method = &quot;euclidean&quot;)
dist_log &lt;- vegdist(abund_log, method = &quot;euclidean&quot;)
dist_rel &lt;- vegdist(abund_rel, method = &quot;euclidean&quot;)</pre>

</article></slide><slide class=""><hgroup><h2>Существуют ли группировки в n-мерном облаке точек?</h2></hgroup><article  id="существуют-ли-группировки-в-n-мерном-облаке-точек">

<p>Самый простой анализ - частотное распределение расстояний между объектами.<br/>Позволяет понять есть ли сгущения в облаке точек в n-мерном пространстве признаков.</p>

<p><strong>Задание:</strong> Создайте вектор, соответствующий развернутой (unfolded) матрице эвклидовых расстояний, основанной на относительных обилиях видов, и постройте частотную гистограмму для этого вектора.</p>

</article></slide><slide class=""><hgroup><h2>Решение</h2></hgroup><article  id="решение-1">

<pre class = 'prettyprint lang-r'>disatances &lt;- data.frame(Init = as.numeric(dist_init), 
                        Stand = as.numeric(dist_stand),
                        Log = as.numeric(dist_log),
                        Rel = as.numeric(dist_rel))


Pl_hist &lt;- ggplot(disatances) + geom_histogram()
Pl_init &lt;- Pl_hist + aes(x = Init) + ggtitle(&quot;Исходные данные&quot;) + labs(x = &quot;Евклидово расстояние&quot;)
Pl_stand &lt;- Pl_hist + aes(x = Stand) + ggtitle(&quot;Стандартизация&quot;) + labs(x = &quot;Евклидово расстояние&quot;)
Pl_log &lt;- Pl_hist + aes(x = Log)  + ggtitle(&quot;Логарифмирование&quot;)+ labs(x = &quot;Евклидово расстояние&quot;)
Pl_rel &lt;- Pl_hist + aes(x = Rel) + ggtitle(&quot;Относительные величины&quot;)+ labs(x = &quot;Евклидово расстояние&quot;)</pre>

</article></slide><slide class=""><hgroup><h2>Существуют ли группировки?</h2></hgroup><article  id="существуют-ли-группировки">

<p><img src="01_multivariate_data_and_dissimilarities_files/figure-html/unnamed-chunk-27-1.png" width="672" style="display: block; margin: auto;" /></p>

</article></slide><slide class=""><hgroup><h2>Структура облака точек</h2></hgroup><article  id="структура-облака-точек">

<p>Если в n-мерном облаке точек присутствуют несколько &ldquo;сгущений&rdquo;, то расстояния между объектами делятся на внутригрупповые (пик в области малых значений расстояний) и межгрупповые (пик в области высоких значений)</p>

<p><img src="01_multivariate_data_and_dissimilarities_files/figure-html/unnamed-chunk-28-1.png" width="672" style="display: block; margin: auto;" /></p>

</article></slide><slide class="segue dark nobackground level1"><hgroup class = 'auto-fadein'><h2>Меры сходства и различия между объектами (Resemblance coefficients)</h2></hgroup><article  id="меры-сходства-и-различия-между-объектами-resemblance-coefficients">

</article></slide><slide class=""><hgroup><h2>От того в чем измерено различие многое зависит</h2></hgroup><article  id="от-того-в-чем-измерено-различие-многое-зависит">

<p>Мы уже знаем, что от способа выражения признаков очень многое зависит.</p>

<p>Однако еще сильнее анализ зависит от того с помощью какой величины (Resemblance coefficients) описывается степень различия между объектам.</p>

<p><strong>Задание:</strong> 1. На базе датасета <code>abund_log</code>, используя функцию <code>vegdist()</code> рассчитайте матрицу различий между объектами (<code>dist_eucl</code>), основанную на евклидовом расстоянии.</p>

<ol>
<li><p>На том же датасете постройте матрицу различий (<code>dist_bray</code>), основанную на методе, называемом &lsquo;bray&rsquo;.</p></li>
<li><p>Разверните обе матрицы в векторы.</p></li>
<li><p>Постройте для этих векторов частотные диаграммы.</p></li>
</ol>

</article></slide><slide class=""><hgroup><h2>Решение</h2></hgroup><article  id="решение-2">

<pre class = 'prettyprint lang-r'>dist_eucl &lt;- vegdist(abund_log, method = &quot;euclidean&quot;)
dist_bray &lt;- vegdist(abund_log, method = &quot;bray&quot;)

dists &lt;- data.frame(Euclidean = as.numeric(dist_eucl), 
                    Bray = as.numeric(dist_bray))

Pl_hist &lt;- ggplot(dists) + geom_histogram()
Pl_eucl &lt;- Pl_hist + aes(x = Euclidean)
Pl_bray &lt;- Pl_hist + aes(x = Bray)</pre>

</article></slide><slide class=""><hgroup><h2>Решение</h2></hgroup><article  id="решение-3">

<pre class = 'prettyprint lang-r'>grid.arrange(Pl_eucl, Pl_bray, ncol = 2)</pre>

<p><img src="01_multivariate_data_and_dissimilarities_files/figure-html/unnamed-chunk-30-1.png" width="672" style="display: block; margin: auto;" /></p>

</article></slide><slide class=""><hgroup><h2>Сходства и различия</h2></hgroup><article  id="сходства-и-различия">

<ul>
<li><p>Сходство (S) достигает максимума, когда объекты обладают идентичными признаками, различиe (D), наоборот - достигает минимума.</p></li>
<li><p>Обычно (но не всегда) коэффициенты сходства распределены от 0 до 1.</p></li>
<li><p>Тогда \(D = 1 - S\), или \(D = \sqrt{1 - S}\), или \(D = \sqrt{1-S^2}\).</p></li>
<li><p>Показатели можно нормировать. \(D_{norm} = \frac{D}{D_{max}}\), или \(D_{norm} = \frac{D - D_{min}}{D_{max} - D_{min}}\).</p></li>
</ul>

<p>В большинстве случаев нас будут интересовать меры различия между объектами</p>

</article></slide><slide class=""><hgroup><h2>Проблема двойных нулей (Double zeros probem)</h2></hgroup><article  id="проблема-двойных-нулей-double-zeros-probem">

<pre >##         D1 D2 D3 D4 D5 D6 D7 D8 D9 D10
## Object1  0  0  0  0  0  0  0  2  2   1
## Object2  0  0  0  0  0  4  5  0  0   1</pre>

<p>О чем говорит то, что признаки D1, D2, D3, D4, D5 не были отмечены у двух объектов?</p>

<ul class = 'build'>
<li>Вариант 1. Это ничего не означает. Признаки D1, D2, D3, D4, D5 можно не учитывать при сравнении объектов 1 и 2.</li>
<li>Вариант 2. Отсутствие признака - дополнительное сходство между объектами. Сходство между объектами 1 и 2 повышается так как у них нет признаков D1, D2, D3, D4, D5, которые возможно есть у других объектов.</li>
</ul>

<ul class = 'build'>
<li>От выбора одного из двух вариантов зависит какой коэффициент использовать в анализе.</li>
</ul>

</article></slide><slide class=""><hgroup><h2>Два типа коэффициентов</h2></hgroup><article  id="два-типа-коэффициентов">

<p>Меры различия <em>не учитывающие</em> двойные нули. Эти коэффициенты не изменяются если в данные будут добавлены двойные нули (например, при увеличении количества описанных объектов).</p>

<p>Примеры:</p>

<ul>
<li>Евклидово расстояние</li>
<li>расстояние по Манхеттену.</li>
</ul>

<p>Меры различия <em>учитывающие</em> двойные нули. Эти коэффициенты изменяются при появлении двойных нулей. Сходство возрастает за счет того, что отсутствие признака считается тоже сходством.</p>

<p>Пример:</p>

<ul>
<li>Коэффициенты корреляции.</li>
</ul>

</article></slide><slide class=""><hgroup><h2>Меры расстояния, или метрики</h2></hgroup><article  id="меры-расстояния-или-метрики">

<p>Свойства:</p>

<ul>
<li>Если \(a = b\), то \(D(a, b) = 0\)</li>
<li>Симметричность \(D(a, b) = D(b, a)\)</li>
<li>Справедливо неравенство треугольника \(D(a,b) + D(b,c) \geq D(a,c)\)</li>
</ul>

<p><em>Важно:</em> метрики неадекватно оценивают степень различия при большом количестве нулей.Очень чувствительны к выбросам.</p>

</article></slide><slide class=""><hgroup><h2>Наиболее популярные меры расстояния</h2></hgroup><article  id="наиболее-популярные-меры-расстояния">

<div class="columns-2">
<p><strong>Нестандартизованные</strong></p>

<ul>
<li>Евклидово расстояние:</li>
</ul>

<p>\[D = \sqrt{\sum(x_{i,j} - x_{i,k})^2}\]</p>

<ul>
<li>Расстояние по Манхеттену (Manhattan metric, taxicab metric, city-block metric):</li>
</ul>

<p>\[D = \sum \mid x_{i,j} - x_{i,k} \mid\]</p>

<p><br /><br /><br /><br /><br /><br /><br /></p>

<p><strong>Стандартизованные</strong></p>

<p>Удобнее так как признаки могут быть измерены в разных шкалах</p>

<ul>
<li>Расстояние по Канберре (Canberra metric):</li>
</ul>

<p>\(D = \frac{1} {p} \sum \frac {\mid x_{i,j} - x_{i,k} \mid} {x_{i,j}+ x_{i,k}}\)</p>

<ul>
<li>Расстояние \(\chi^2\)</li>
</ul>

<p>\(\chi^2 = \sqrt{ \sum {\frac{1}{c_i}} (x_{i,j} - x_{i,k})^2}\)</p>

<ul>
<li>Евклидово расстояние, вычисленное по относительным величинам.</li>
</ul></div>

</article></slide><slide class=""><hgroup><h2>Неметрические коэффициенты различия</h2></hgroup><article  id="неметрические-коэффициенты-различия">

<ul>
<li>Корреляция Браве-Пирсона: \[ R = \frac {cov(X, Y)}{\sqrt{\sigma_x^2\sigma_y^2}} \]</li>
</ul>

<p>Коэффициент Браве-Пирсона варьирует от -1 до 1.</p>

<p>Обычно используется в R анализе</p>

<ul>
<li>Коэффициент Брея-Куртиса (Bray-Curtis dissimilarity): \[D = \frac{\sum \mid x_{i,j} - x_{i,k} \mid} {\sum x_{i,j} + \sum x_{i,k}}\]</li>
</ul>

<p>Это самый распространенный коэффициент в экологии.</p>

</article></slide><slide class=""><hgroup><h2>Коэффициенты для бинарных данных</h2></hgroup><article  id="коэффициенты-для-бинарных-данных">

<p>В основе лежит четырехпольная таблица</p>

<p>\[\begin{vmatrix} \, &amp; + &amp; - \\ + &amp; a &amp; b \\ - &amp; c &amp; d \end{vmatrix}\]</p>

<ul>
<li>a - сходство объектов по наличию признака</li>
<li>b - различие</li>
<li>c - различие</li>
<li>d - сходство по отсутствию признака</li>
</ul>

</article></slide><slide class=""><hgroup><h2>Коэффициенты для бинарных данных</h2></hgroup><article  id="коэффициенты-для-бинарных-данных-1">

<ul>
<li>Доля несовпадений:</li>
</ul>

<p>\[D = \frac{b+c}{a+b+c}\]</p>

<ul>
<li>Коэффициент Жаккара:</li>
</ul>

<p>\[S = \frac{a}{a+b+c}\]</p>

<ul>
<li>Коэффициент Сёренсена:</li>
</ul>

<p>\[S = \frac{2a}{2a + b + c}\]</p>

<p><em>NB!</em> Коэффициент Сёренсена - это коэффициент Брея-Куртиса, вычисленный для значений, оцененных как 1 или 0.</p>

</article></slide><slide class=""><hgroup><h2>Коэффициенты для бинарных данных</h2></hgroup><article  id="коэффициенты-для-бинарных-данных-2">

<ul>
<li>\(\phi\)-корреляция Пирсона</li>
</ul>

<p>\[\phi = \frac{ad-bc}{(a+b)(c+d)(a+c)(b+d)}\]</p>

<p>Используется в R-анализе</p>

<p><br /><br /><br /><br /><br /><br /><br /><br /><br /></p>

</article></slide><slide class=""><hgroup><h2>Коэффициент Говера</h2></hgroup><article  id="коэффициент-говера">

<p>Обобщенный коэффициент, который применяется для случаев, когда одни признаки объекта описаны, как количественные величины, а другие - как бинарные данные (или даже качественные данные).</p>

<p>\[ D = \frac{1}{p} \frac{\sum W_i\dfrac{\mid x_{i,j} - x_{i,k} \mid}{\max x_{i,j} - \min x_{i,k}}}{\sum W_i}\]</p>

<p>\(W_i=0\) Если отсутствует информация o \(x_{i,j}\) и/или \(x_{i,k}\) отсутствует</p>

<p>\(W_i=1\) Если присутствует информация как о \(x_{i,j}\) так и о \(x_{i,k}\)</p>

</article></slide><slide class=""><hgroup><h2>Отчего зависит выбор коэффициента?</h2></hgroup><article  id="отчего-зависит-выбор-коэффициента">

<ol>
<li>От природы материала (признаки могут иметь количественную, бинарную и качественную оценку).</li>
<li>От характера тестируемой гипотезы (какой аспект природы сходства-различия хочет выразить автор).</li>
<li>В экологии: от того, насколько мы хотим учитывать вклад редких и малочисленных видов.</li>
<li>От взглядов исследователя на природу сходства/различия между объектами.</li>
<li>От типа анализа (R или Q)</li>
</ol>

</article></slide><slide class=""><hgroup><h2>Многие показатели взаимосвязаны и, часто, взаимозаменяемы</h2></hgroup><article  id="многие-показатели-взаимосвязаны-и-часто-взаимозаменяемы">

<p><img src="01_multivariate_data_and_dissimilarities_files/figure-html/unnamed-chunk-32-1.png" width="672" style="display: block; margin: auto;" /></p>

</article></slide><slide class="segue dark nobackground level1"><hgroup class = 'auto-fadein'><h2>Ординация – основной метод описания многомерных данных</h2></hgroup><article  id="ординация-основной-метод-описания-многомерных-данных">

</article></slide><slide class=""><hgroup><h2>Многомерные объекты, их свойства и внешние факторы</h2></hgroup><article  id="многомерные-объекты-их-свойства-и-внешние-факторы">

<table class = 'rmdtable'>
<col width="26.666667%" />
<col width="21.666667%" />
<col width="16.666667%" />
<col width="35.000000%" />
<tr class="header">
<th align="left">Элемент анализа</th>
<th align="left">(син)экология</th>
<th align="left">морфология</th>
<th align="left">молекулярная биология</th>
</tr>
<tr class="odd">
<td align="left">Объекты</td>
<td align="left">площадки / пробы</td>
<td align="left">особи / клетки и т.п.</td>
<td align="left">особи / клетки и т.п.</td>
</tr>
<tr class="even">
<td align="left">Собственные свойства объектов</td>
<td align="left">численность / биомасса особей разных видов</td>
<td align="left">измерения, свойства</td>
<td align="left">интенсивность экспрессии гена/пептида</td>
</tr>
<tr class="odd">
<td align="left">Внешние факторы</td>
<td align="left">свойства среды</td>
<td align="left">свойства среды / особей / клеток</td>
<td align="left">свойства среды / особей / клеток</td>
</tr>
</table>

<p><strong>По аналогии с одномерными линейными моделями</strong></p>

<ul>
<li>Объекты – Измерения<br/></li>
<li>Свойства объектов – Зависимая переменная</li>
<li>Внешние факторы – Предикторы</li>
</ul>

</article></slide><slide class=""><hgroup><h2>Ординация</h2></hgroup><article  id="ординация">

<p><strong>Ординация</strong> (лат. <em>ordinatio</em> — расположение в порядке) — это упорядочивание объектов вдоль некоторых осей, определяющих варьирование свойств этих объектов.</p>

<p>Если у объектов всего два свойства, то ординация имеет вид облака точек в двух осях.</p>

<p><img src="01_multivariate_data_and_dissimilarities_files/figure-html/unnamed-chunk-33-1.png" width="672" style="display: block; margin: auto;" /></p>

<p>Аналогия ординации с одномерными методами – просто числовой ряд.</p>

</article></slide><slide class=""><hgroup><h2>Ординация в сокращенном пространстве признаков (Оrdination in reduced space)</h2></hgroup><article  id="ординация-в-сокращенном-пространстве-признаков-оrdination-in-reduced-space">

<p>Если признаков становится больше двух, то визуализация взаиморасположения объектов в n-мерном пространстве признаков становится невозможной. Для этого применяют разные способы получения &ldquo;образа&rdquo; n-мерного облака:</p>

<p><strong>Старинные методы:</strong></p>

<ul>
<li>Висконсинская полярная ординация (Bray and Curtis, 1957)</li>
</ul>

<p><strong>Современные методы:</strong></p>

<ul>
<li>Метрическое многомерное шкалирование (MDS)</li>
<li>Неметричекое многомерное шкалирование (nMDS)</li>
<li>Метод главных компонент (PCA)</li>
<li>Корреспондентный анализ (CA)</li>
</ul>

</article></slide><slide class=""><hgroup><h2>Висконсинская полярная ординация</h2></hgroup><article  id="висконсинская-полярная-ординация">

<p>Это простейший прием ординации в сокращенном пространстве</p>

<p>Шаг 1. Подготовка данных для анализа.</p>

<p>Логарифмирование мы провели ранее</p>

<pre class = 'prettyprint lang-r'>row.names(abund_rel) &lt;- abund$Station</pre>

</article></slide><slide class=""><hgroup><h2>Висконсинская полярная ординация</h2></hgroup><article  id="висконсинская-полярная-ординация-1">

<p>Шаг 2. Вычисление матрицы сходства/различия между объектами.<br/>Из дидактических соображений возьмем матрицу Евклидовых расстояний.</p>

<pre class = 'prettyprint lang-r'>library(vegan)
E_dist &lt;- vegdist(abund_log, method = &quot;euclidean&quot;)</pre>

</article></slide><slide class=""><hgroup><h2>Висконсинская полярная ординация</h2></hgroup><article  id="висконсинская-полярная-ординация-2">

<p>Шаг 3. Найдем наиболее различающиеся объекты (максимальное Евклидово расстояние между ними).</p>

<pre >##         i Object_j Object_k Distance
## 1991 1991       44       57     36.6</pre>

<p>Эти два объекта и задают ось, вдоль которой будет производиться ординация.</p>

</article></slide><slide class=""><hgroup><h2>Висконсинская полярная ординация</h2></hgroup><article  id="висконсинская-полярная-ординация-3">

<p>Шаг 4. Координаты каждого из объектов на этой оси могут быть найдены, согласно правилам треугольника</p>

<p>Возьмем любую другую точку, например &ldquo;S2&rdquo;</p>

<p><img src="01_multivariate_data_and_dissimilarities_files/figure-html/unnamed-chunk-38-1.png" width="672" style="display: block; margin: auto;" /></p>

</article></slide><slide class=""><hgroup><h2>Висконсинская полярная ординация</h2></hgroup><article  id="висконсинская-полярная-ординация-4">

<p>Шаг 5. Вычисляем координаты на полярной оси для каждого объекта.</p>

<p><img src="01_multivariate_data_and_dissimilarities_files/figure-html/unnamed-chunk-39-1.png" width="672" style="display: block; margin: auto;" /></p>

</article></slide><slide class=""><hgroup><h2>Висконсинская полярная ординация</h2></hgroup><article  id="висконсинская-полярная-ординация-5">

<p>Шаг 6. При необходимости, находим следующую пару наиболее несходных объектов и вычисляем координаты для каждой точки на новой оси.</p>

<p><em>At!</em> Одновременное изображение информации об обеих полярных осях на одной диаграмме невозможно!<br/>Мы не знаем как взаимосвязаны эти оси. Они могут быть неортогональны.</p>

</article></slide><slide class=""><hgroup><h2>Интерпретация результатов ординации</h2></hgroup><article  id="интерпретация-результатов-ординации">

<p>Сама по себе ординация - это лишь визуализация структуры многомерных данных.</p>

<p>Исследователю важно объяснить, с какими внешними факторами связана наблюдаемая ординация.</p>

</article></slide><slide class=""><hgroup><h2>Пример: Структура сообщества и градиент температуры</h2></hgroup><article  id="пример-структура-сообщества-и-градиент-температуры">

<p>С помощью Висконсинской полярной ординации мы получили градиент точек на полярной оси.</p>

<p>Этот градиент связан с внешним фактором - температурой.</p>

<p><img src="01_multivariate_data_and_dissimilarities_files/figure-html/unnamed-chunk-40-1.png" width="672" style="display: block; margin: auto;" /></p>

</article></slide><slide class=""><hgroup><h2>Две схемы интерпретации</h2></hgroup><article  id="две-схемы-интерпретации">

<p>Методы интерпретации многомерных данных делят на две большие группы (ter Braak, 1987; Legendre &amp; Legendre, 2014):</p>

<ul>
<li><p>Непрямая интерпретация (<em>indirect gradient analysis</em>, <em>indirect comparison</em>)</p></li>
<li><p>Прямая интерпретация (<em>direct gradient analysis</em>, <em>direct comparison</em>)</p></li>
</ul>

</article></slide><slide class=""><hgroup><h2>Методы непрямой интерпретации</h2></hgroup><article  id="методы-непрямой-интерпретации" class="columns-2 smaller">

<p>Синоним – неограниченная ординация (<em>unconstrained ordination</em>).</p>

<p>Мы строим ординацию (или используем иной тип визуализации), основанную на свойствах самих объектов, далее пытаемся связать эту ординацию с внешними факторами.</p>

<p><strong>Методы неограниченной ординации:</strong></p>

<ul>
<li>Висконсинская полярная ординация</li>
<li>неметрическое многомерное шкалирование (<em>non-Metric Multidimensional Scaling</em>, nMDS)</li>
<li>анализ главных компонент (<em>Principal Component Analysis</em>, PCA)</li>
<li>корреспондентный анализ (<em>Correspondence Analysis</em>, CA).</li>
</ul>

<p>После построения ординации на нее накладывают информацию о внешних факторах:</p>

<p><br> <strong>Простейший способ:</strong> Построить точечные диаграммы, отражающие связь координат осей ординации с той или иной внешней переменной.</p>

<p><img src="01_multivariate_data_and_dissimilarities_files/figure-html/unnamed-chunk-41-1.png" width="480" style="display: block; margin: auto;" /></p>

</article></slide><slide class=""><hgroup><h2>Задание</h2></hgroup><article  id="задание-2">

<p>Вычислите значения координат полярной ординации, основанной на относительных обилиях видов (<code>abund_rel</code>) и постройте точечную диаграмму, отражающую связь этой ординации с глубиной, температурой? соленостью и обводненностью грунта.</p>

</article></slide><slide class=""><hgroup><h2>Решение</h2></hgroup><article  id="решение-4" class="smaller">

<pre class = 'prettyprint lang-r'>New_coord2 &lt;- polarord(abund_rel)

Pl_1 &lt;- qplot(hydrol$Temp, New_coord2$Coord) + labs(x = &quot;Температура&quot;, y = &quot;Координаты ординации&quot;)
Pl_2 &lt;- qplot(hydrol$Depth, New_coord2$Coord) + labs(x = &quot;Глубина&quot;, y = &quot;Координаты ординации&quot;)
Pl_3 &lt;- qplot(hydrol$Sal, New_coord2$Coord) + labs(x = &quot;Соленость&quot;, y = &quot;Координаты ординации&quot;)
Pl_4 &lt;- qplot(hydrol$Water_content, New_coord2$Coord) + labs(x = &quot;Обводненность&quot;, y = &quot;Координаты ординации&quot;)</pre>

</article></slide><slide class=""><hgroup><h2>Решение</h2></hgroup><article  id="решение-5" class="smaller">

<pre class = 'prettyprint lang-r'>grid.arrange(Pl_1, Pl_2, Pl_3, Pl_4, ncol = 2)</pre>

<p><img src="01_multivariate_data_and_dissimilarities_files/figure-html/unnamed-chunk-43-1.png" width="672" style="display: block; margin: auto;" /></p>

</article></slide><slide class=""><hgroup><h2>Методы прямой интерпретации</h2></hgroup><article  id="методы-прямой-интерпретации" class="columns-2 smaller">

<p>Синоним – ограниченная ординация (<em>constrained ordination</em>).</p>

<p>Для построения ординации в один анализ включаются и свойства объектов и внешние факторы. Итоговая ординация отражает результат взаимосвязи свойств объектов с внешними факторами.</p>

<p>Методы прямой ординации позволяют тестировать гипотезы о влиянии различных внешних переменных на свойства многомерных объектов:</p>

<p><strong>Методы ограниченной ординации:</strong></p>

<ul>
<li>анализ избыточности (<em>Redundancy Analysis</em>, RDA)</li>
<li>канонический корреспондентный анализ (<em>Canonical Correspondence Analysis</em>, CCA).</li>
</ul>

</article></slide><slide class=""><hgroup><h2>Summary</h2></hgroup><article  id="summary">

<ul class = 'build'>
<li>Существует два подхода к анализу многомерных данных:</li>
<li>подход, основанный на линейной алгебре,</li>
<li>подход, основанный на исследовании матриц сходства/различия между объектами.</li>
<li>Выбор коэффициентов сходств/различия - непростая задача, решение которой зависит от структуры материала и поставленных задач. Разные коэффициенты потенциально могут давать разные результаты.</li>
<li>Получить важную информацию о взаиморасположении объектов можно с помощью некоторых простейших методов.</li>
</ul>

</article></slide><slide class=""><hgroup><h2>Что почитать</h2></hgroup><article  id="что-почитать">

<ul>
<li>Legendre P., Legendre L. (1998) Numerical ecology. Second english edition. Elsevier, Amsterdam. (Фундаментальный труд, описывающий большинство методов. Дается исчерпывающее обсуждение разнообразных коэффициентов сходства/различия)</li>
<li>Zuur, A. F., Ieno, E. N., Smith, G. M. Analysing Ecological Data. Springer 2007 (Практически все то же самое, что в L&amp;L, но написанное простым языком)</li>
<li>Clarke, K. R., Gorley R. N. (2006) PRIMER v6: User Manual/Tutorial. PRIMER-E, Plymouth. (Очень доходчиво написанное руководство, дающее общее представление о &ldquo;механике&rdquo; работы многомерных методов)</li>
<li>Миркин Б.М., Розенберг Г.С. Фитоценология. Принципы и методы. М., 1978. (Руководство написано в докомпьютерную эпоху, но простейшие методы изложены очень хорошо)</li>
<li>Василевич В.И. Статистические методы в геоботанике. - Л.: Наука, 1969.</li>
<li>Дюран Б., Оделл П. Кластерный анализ. М.: Статистика, 1977</li>
</ul></article></slide>


  <slide class="backdrop"></slide>

</slides>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

<!-- map slide visiblity events into shiny -->
<script>
  (function() {
    if (window.jQuery) {
       window.jQuery(document).on('slideleave', function(e) {
         window.jQuery(e.target).trigger('hidden');
      });
       window.jQuery(document).on('slideenter', function(e) {
         window.jQuery(e.target).trigger('shown');
      });
    }
  })();
</script>

</body>
</html>
